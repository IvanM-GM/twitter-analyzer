# Архітектурні схеми та діаграми

## 1. Діаграма компонентів системи

```mermaid
graph TB
    A[Frontend React App] --> B[Backend API Server]
    B --> C[Twitter Scraper]
    B --> D[Image Analyzer]
    B --> E[GPT Service]
    C --> F[Twitter.com]
    D --> G[Image Processing]
    E --> H[OpenAI API]
    
    subgraph "Frontend (Windows)"
        A
    end
    
    subgraph "Backend (Linux Server)"
        B
        C
        D
        E
    end
    
    subgraph "External Services"
        F
        G
        H
    end
```

## 2. Послідовність обробки запиту

```mermaid
sequenceDiagram
    participant U as User
    participant F as Frontend
    participant B as Backend
    participant T as Twitter Scraper
    participant I as Image Analyzer
    participant G as GPT Service
    participant O as OpenAI API

    U->>F: Вводить Twitter URL
    F->>B: POST /api/v1/analyze
    B->>T: Парсинг Twitter посту
    T->>B: Текст + зображення
    B->>I: Аналіз зображень
    I->>B: Опис зображень
    B->>G: Формування запиту до GPT
    G->>O: API запит
    O->>G: Згенеровані коментарі
    G->>B: Коментарі
    B->>F: Результат
    F->>U: Відображення коментарів
```

## 3. Структура бази даних

```mermaid
erDiagram
    REQUESTS {
        int id PK
        string twitter_url
        string post_text
        string image_urls
        datetime created_at
        string status
    }
    
    COMMENTS {
        int id PK
        int request_id FK
        string comment_text
        string style_type
        datetime generated_at
    }
    
    API_LOGS {
        int id PK
        int request_id FK
        string endpoint
        int response_time
        string status_code
        datetime timestamp
    }
    
    REQUESTS ||--o{ COMMENTS : "has"
    REQUESTS ||--o{ API_LOGS : "logs"
```

## 4. Діаграма класів Backend

```mermaid
classDiagram
    class TwitterScraper {
        +scrape_post(url: string): PostData
        +validate_url(url: string): boolean
        +extract_text(html: string): string
        +extract_images(html: string): string[]
    }
    
    class ImageAnalyzer {
        +analyze_image(image_url: string): ImageDescription
        +detect_objects(image: bytes): Object[]
        +generate_description(objects: Object[]): string
    }
    
    class GPTService {
        +generate_comments(post_data: PostData): Comment[]
        +create_prompt(post_text: string, image_desc: string): string
        +call_openai_api(prompt: string): string
    }
    
    class CommentGenerator {
        +generate(post_data: PostData): Comment[]
        +validate_comments(comments: Comment[]): boolean
        +format_comments(comments: Comment[]): FormattedComment[]
    }
    
    class PostData {
        +string text
        +string[] image_urls
        +string[] image_descriptions
        +datetime timestamp
    }
    
    class Comment {
        +string text
        +string style
        +float relevance_score
        +datetime generated_at
    }
    
    TwitterScraper --> PostData
    ImageAnalyzer --> PostData
    GPTService --> Comment
    CommentGenerator --> Comment
```

## 5. Діаграма станів запиту

```mermaid
stateDiagram-v2
    [*] --> Pending
    Pending --> Validating
    Validating --> Scraping : URL valid
    Validating --> Failed : URL invalid
    Scraping --> Analyzing : Content scraped
    Scraping --> Failed : Scraping failed
    Analyzing --> Generating : Analysis complete
    Analyzing --> Failed : Analysis failed
    Generating --> Completed : Comments generated
    Generating --> Failed : Generation failed
    Failed --> [*]
    Completed --> [*]
```

## 6. Діаграма розгортання

```mermaid
graph TB
    subgraph "Windows Client"
        A[React App]
        B[Node.js Runtime]
    end
    
    subgraph "Linux Server"
        C[Nginx Reverse Proxy]
        D[Python Backend]
        E[PostgreSQL Database]
        F[Redis Cache]
    end
    
    subgraph "External Services"
        G[Twitter.com]
        H[OpenAI API]
        I[Image Processing Services]
    end
    
    A --> C
    C --> D
    D --> E
    D --> F
    D --> G
    D --> H
    D --> I
```

## 7. Діаграма безпеки

```mermaid
graph LR
    A[User Input] --> B[Input Validation]
    B --> C[Rate Limiting]
    C --> D[Authentication]
    D --> E[Authorization]
    E --> F[Business Logic]
    F --> G[Output Sanitization]
    G --> H[Response]
    
    subgraph "Security Layers"
        B
        C
        D
        E
        G
    end
```

## 8. Моніторинг та логування

```mermaid
graph TB
    A[Application] --> B[Logging Service]
    B --> C[Log Storage]
    B --> D[Error Tracking]
    
    E[Metrics Collector] --> F[Monitoring Dashboard]
    E --> G[Alerting System]
    
    A --> E
    
    subgraph "Observability Stack"
        B
        C
        D
        E
        F
        G
    end
```

## 9. Діаграма тестування

```mermaid
graph TB
    A[Test Suite] --> B[Unit Tests]
    A --> C[Integration Tests]
    A --> D[E2E Tests]
    A --> E[Load Tests]
    
    B --> F[Component Testing]
    C --> G[API Testing]
    D --> H[User Workflow Testing]
    E --> I[Performance Testing]
    
    F --> J[Test Results]
    G --> J
    H --> J
    I --> J
```

## 10. Діаграма CI/CD Pipeline

```mermaid
graph LR
    A[Code Commit] --> B[Code Review]
    B --> C[Automated Tests]
    C --> D[Build]
    D --> E[Security Scan]
    E --> F[Deploy to Staging]
    F --> G[Integration Tests]
    G --> H[Deploy to Production]
    H --> I[Health Checks]
    
    subgraph "CI/CD Pipeline"
        B
        C
        D
        E
        F
        G
        H
        I
    end
```

## 11. Діаграма масштабування

```mermaid
graph TB
    A[Load Balancer] --> B[Backend Instance 1]
    A --> C[Backend Instance 2]
    A --> D[Backend Instance N]
    
    B --> E[Database Cluster]
    C --> E
    D --> E
    
    F[Cache Cluster] --> G[Redis Master]
    F --> H[Redis Slave 1]
    F --> I[Redis Slave 2]
    
    B --> F
    C --> F
    D --> F
```

## 12. Діаграма відмовостійкості

```mermaid
graph TB
    A[Primary Service] --> B[Fallback Service]
    A --> C[Circuit Breaker]
    C --> D[Retry Logic]
    
    E[Health Check] --> F[Service Discovery]
    F --> G[Load Balancer]
    
    H[Monitoring] --> I[Alert System]
    I --> J[Auto Recovery]
    
    subgraph "Resilience Patterns"
        C
        D
        E
        F
        H
        I
        J
    end
```

## 13. Діаграма конфігурації

```mermaid
graph LR
    A[Environment Variables] --> B[Configuration Service]
    B --> C[Application Config]
    B --> D[Database Config]
    B --> E[API Config]
    
    F[Secrets Management] --> G[API Keys]
    F --> H[Database Credentials]
    F --> I[External Service Tokens]
    
    C --> J[Backend Application]
    D --> J
    E --> J
    G --> J
    H --> J
    I --> J
```

## 14. Діаграма інтеграції зовнішніх сервісів

```mermaid
graph TB
    A[Application] --> B[Twitter Scraping]
    A --> C[OpenAI Integration]
    A --> D[Image Analysis]
    
    B --> E[Twitter.com]
    C --> F[GPT-4o-mini API]
    D --> G[Computer Vision API]
    
    H[Rate Limiting] --> I[Request Queue]
    I --> J[Response Cache]
    
    subgraph "External Integrations"
        E
        F
        G
    end
    
    subgraph "Performance Optimization"
        H
        I
        J
    end
```

## 15. Діаграма користувацького інтерфейсу

```mermaid
graph TB
    A[Main Page] --> B[URL Input Form]
    A --> C[Results Display]
    A --> D[Settings Panel]
    
    B --> E[URL Validation]
    E --> F[Submit Button]
    
    C --> G[Comment List]
    C --> H[Copy to Clipboard]
    C --> I[Export Options]
    
    D --> J[API Configuration]
    D --> K[Theme Settings]
    D --> L[Language Selection]
    
    subgraph "UI Components"
        B
        C
        D
        E
        F
        G
        H
        I
        J
        K
        L
    end
```
